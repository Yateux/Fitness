import React from 'react';
import styled from 'styled-components';

// --- Composants Stylisés ---

const Wrapper = styled.div`
  display: inline-flex;
  align-items: center;
  /* L'espace entre l'icône et le texte reste proportionnel à la taille */
  gap: ${props => props.$size / 4}px;
  font-family: sans-serif;
`;

const ChartSvg = styled.svg`
  transform: rotate(-90deg);
  display: block;
  flex-shrink: 0;
`;

const ChartCircle = styled.circle`
  fill: none;
  stroke-width: ${props => props.$strokeWidth}px;
  stroke-linecap: round;
  transition: all 0.3s ease;
  
  /* On passe les calculs dynamiques via les props */
  stroke: ${props => props.$color};
  stroke-dasharray: ${props => props.$dashArray};
  stroke-dashoffset: ${props => props.$dashOffset};
`;

// --- Composant Principal ---

const DynamicUsageChart = ({ size = 30, strokeWidth = 4, percentage = 25 }) => {
  // Logique de calcul identique
  const radius = (size - strokeWidth) / 2;
  const circumference = 2 * Math.PI * radius;
  const autoGap = circumference * 0.05;
  
  const orangeSegment = (percentage / 100) * circumference - autoGap;
  const blueSegment = ((100 - percentage) / 100) * circumference - autoGap;

  return (
    <Wrapper $size={size}>
      <ChartSvg
        width={size}
        height={size}
        viewBox={`0 0 ${size} ${size}`}
      >
        {/* Segment Bleu */}
        <ChartCircle
          cx={size / 2}
          cy={size / 2}
          r={radius}
          $strokeWidth={strokeWidth}
          $color="#6d8bc4"
          $dashArray={`${blueSegment} ${circumference - blueSegment}`}
          $dashOffset={-( (percentage / 100) * circumference + autoGap / 2 )}
        />

        {/* Segment Orange */}
        <ChartCircle
          cx={size / 2}
          cy={size / 2}
          r={radius}
          $strokeWidth={strokeWidth}
          $color="#f08036"
          $dashArray={`${orangeSegment} ${circumference - orangeSegment}`}
          $dashOffset={-autoGap / 2}
        />
      </ChartSvg>
    </Wrapper>
  );
};

export default DynamicUsageChart;
